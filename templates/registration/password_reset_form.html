{% extends 'base.html' %}

{% block title %}Reset Password - JigsimurHerbal{% endblock %}

{% block content %}
<div class="container py-5" style="min-height: 100vh;">
  <div class="row justify-content-center">
    <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">
      <div class="card shadow border-0 rounded-3">
        <div class="card-body p-5">
          <!-- Header -->
          <div class="text-center mb-5">
            <div class="mb-3">
              <i class="fas fa-key fa-2x text-success"></i>
            </div>
            <h3 class="text-success fw-bold mb-2">Reset Your Password</h3>
            <p class="text-muted">Enter your email address and we'll send you a link to reset your password</p>
          </div>

          <!-- Password Reset Form -->
          <form method="post" novalidate>
            {% csrf_token %}

            <!-- Email Field -->
            <div class="mb-5">
              <label for="{{ form.email.id_for_label }}" class="form-label small fw-medium">
                <i class="fas fa-envelope me-2 text-success"></i>Email Address
              </label>
              <input type="email" name="email" class="form-control" placeholder="Enter your registered email address"
                id="{{ form.email.id_for_label }}" value="{{ form.email.value|default:'' }}" required>
              <div class="form-text">
                <i class="fas fa-info-circle me-1"></i>
                We'll send password reset instructions to this email address
              </div>
              {% if form.email.errors %}
              <div class="invalid-feedback d-block">
                {% for error in form.email.errors %}
                <small>{{ error }}</small>
                {% endfor %}
              </div>
              {% endif %}
            </div>

            <!-- Non-field errors -->
            {% if form.non_field_errors %}
            <div class="alert alert-danger">
              {% for error in form.non_field_errors %}
              {{ error }}
              {% endfor %}
            </div>
            {% endif %}

            <!-- Send Reset Link Button -->
            <div class="d-grid mb-5">
              <button type="submit" class="btn btn-success py-3">
                <i class="fas fa-paper-plane me-2"></i>Send Reset Link
              </button>
            </div>

            <!-- Back to Login -->
            <div class="text-center">
              <p class="mb-0">
                <a href="{% url 'users:login' %}" class="text-decoration-none text-success fw-semibold">
                  <i class="fas fa-arrow-left me-2"></i>Back to Login
                </a>
              </p>
            </div>
          </form>
        </div>

        <!-- Security Info -->
        <div class="card-footer bg-light text-center py-3">
          <small class="text-muted">
            <i class="fas fa-shield-alt me-2 text-success"></i>
            For security reasons, reset links expire in 1 hour
          </small>
        </div>
      </div>

      <!-- Help Section -->
      <div class="card mt-4 border-0 bg-transparent">
        <div class="card-body text-center">
          <h6 class="text-muted mb-3">Need Help?</h6>
          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="p-3 bg-white rounded shadow-sm">
                <i class="fas fa-clock fa-2x text-info mb-2"></i>
                <h6 class="fw-semibold">Check Your Email</h6>
                <small class="text-muted">The reset link should arrive within a few minutes</small>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="p-3 bg-white rounded shadow-sm">
                <i class="fas fa-question-circle fa-2x text-warning mb-2"></i>
                <h6 class="fw-semibold">Still Having Issues?</h6>
                <small class="text-muted">
                  <a href="mailto:support@jigsimurherbal.com" class="text-decoration-none">
                    Contact Support
                  </a>
                </small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector('form');
    const emailInput = document.querySelector('input[type="email"]');

    // Email validation
    emailInput.addEventListener('blur', function () {
      validateEmail(this);
    });

    emailInput.addEventListener('input', function () {
      if (this.classList.contains('is-invalid')) {
        validateEmail(this);
      }
    });

    function validateEmail(field) {
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const isValid = emailPattern.test(field.value);
      field.classList.toggle('is-valid', isValid && field.value.trim() !== '');
      field.classList.toggle('is-invalid', !isValid && field.value.trim() !== '');
    }
  });
</script>
{% endblock %}
